<!DOCTYPE html>
<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="./mixins/game-container-mixin.html">
<link rel="import" href="./styles/container-shared-styles.html">
<link rel="import" href="./tile-cell.html">

<dom-module id="tile-container">
    <template>
        <style include="container-shared-styles">
        </style>
    </template>
    <script>
        class TileContainer extends GameContainerMixin(Polymer.Element) {
            static get is() {
                return 'tile-container';
            }

            /**
             * Overriden from super class
             */
            _cellsChanged() {
                super._cellsChanged();
                this.__removeTiles();
                this.__addTiles();
            }

            __addTiles() {
                this.cells.forEach((row, rowIndex) => {
                    row.forEach((value, columnIndex) => {
                        let cell = new TileCell();
                        cell.setProperties({
                            value,
                            column: columnIndex,
                            row: rowIndex
                        });
                        this.shadowRoot.appendChild(cell);
                    });
                });
            }

            __removeTiles() {
                Array.from(this.shadowRoot.children)
                    .forEach((el, index) => {
                        if (el instanceof TileCell) {
                            this.shadowRoot.removeChild(el);
                        }
                    });
            }
        }
        customElements.define(TileContainer.is, TileContainer);
    </script>
</dom-module>